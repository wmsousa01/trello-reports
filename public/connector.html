<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Cache-Control" content="no-store" />
    <title>Trello Reports â€” Connector</title>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <script>
      (function () {
        const ICON = { url: "https://cdn-icons-png.flaticon.com/512/1828/1828778.png", alt: "Dashboard" };
        const APP  = "https://trello-reports.vercel.app/index.html";

        function buildUrl(t) {
          const ctx = t.getContext ? t.getContext() : {};
          const boardId = ctx && ctx.board ? ctx.board : "CUUp9Mv3";
          return `${APP}?boardId=${boardId}&mode=public&access=devtoken`;
        }

        window.TrelloPowerUp.initialize(
          {
            "board-buttons": (t) => [
              {
                icon: ICON,
                text: "ðŸ“Š Abrir Dashboard",
                condition: "always",
                callback: async () => {
                  const url = buildUrl(t);
                  return t.modal({
                    title: "ðŸ“Š Dashboard",
                    url: await t.signUrl(url),
                    fullscreen: true
                  });
                }
              }
            ],
            "board-views": (t) => [
              {
                url: async () => await t.signUrl(buildUrl(t)),
                name: "ðŸ“Š Dashboard",
                icon: ICON
              }
            ],
            "show-settings": async (t) => {
              const url = buildUrl(t);
              return t.modal({ title: "ðŸ“Š Dashboard", url: await t.signUrl(url), fullscreen: true });
            }
          },
          {
            appName: "Trello Reports",
            appKey: "7e9b8d1cfbe5742d0417872d32657a84"
          }
        );
      })();
    </script>
  </head>
  <body></body>
</html>
